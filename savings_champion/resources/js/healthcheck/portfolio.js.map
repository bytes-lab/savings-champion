{"version":3,"sources":["healthcheck/portfolio.coffee"],"names":[],"mappings":"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","file":"healthcheck/portfolio.js","sourceRoot":"/source/","sourcesContent":["body = $('body')\n\n$.ajaxSetup beforeSend: (xhr, settings) ->\n  getCookie = (name) ->\n    if document.cookie and document.cookie isnt \"\"\n      cookies = document.cookie.split(\";\")\n      i = 0\n      if typeof String::trim isnt \"function\"\n        String::trim = ->\n          @replace /^\\s+|\\s+$/g, \"\"\n      while i < cookies.length\n        cookie = cookies[i].trim()\n\n        # Does this cookie string begin with the name we want?\n        if cookie.substring(0, name.length + 1) is (name + \"=\")\n          cookieValue = decodeURIComponent(cookie.substring(name.length + 1))\n          break\n        i++\n    cookieValue\n\n  # Only send the token to relative URLs i.e. locally.\n  xhr.setRequestHeader \"X-CSRFToken\", getCookie(\"csrftoken\")  unless /^http:.*/.test(settings.url) or /^https:.*/.test(settings.url)\n\ncheckOpening = (optionValue) ->\n  \"use strict\"\n  $.post \"/best-buys/ajax/checkopening/\",\n    productID: optionValue\n  , (data) ->\n    opening_date_group = $(\".opening-date-group\")\n    if data is \"True\"\n      opening_date_group.show()\n      opening_date_group.find(\".datestyle\").addClass \"required\"\n      opening_date_group.find(\".datestyle\").attr \"min\", \"1\"\n    else\n      opening_date_group.find(\".datestyle\").removeClass \"required\"\n      opening_date_group.find(\".datestyle\").removeAttr \"min\"\n      opening_date_group.hide()\n\nretrieveProducts = (provider, balance, parent) ->\n  \"use strict\"\n  product_select = $(\"select.productselect\")\n  product_select.select2()\n  product_select.empty()\n  product_select.select2 'data',\n    id: '-1'\n    text: 'Loading'\n  $.get \"/best-buys/ajax/retrievepersonalproducts/\",\n    providerid: provider\n    balanceval: balance\n  , (data) ->\n    options = \"<option value=''>Please select a product</option>\"\n    $.each data, (i) ->\n      options += \"<option value=\\\"\" + data[i][0] + \"\\\">\" + data[i][1] + \"</option>\"\n\n    checkOpening data[0][0]  if data[0] isnt `undefined`\n    product_select.empty()\n    product_select.append options\n    product_select.select2 \"enable\", true\n    product_select.select2 'data',\n      id: '0'\n      text: 'Please select a product'\n\nretrieveAccountType = (provider) ->\n  \"use strict\"\n  edit_reminder_form = $(\".fixed-product-form\")\n  account_type_select = edit_reminder_form.find(\"select.account-type\")\n  account_type_select.empty()\n  account_type_select.append \"<option value=''>Loading</option>\"\n  $.get \"/best-buys/ajax/retrievefixedchoices/\",\n    providerid: provider\n  , (data) ->\n    account_type_select.empty()\n    options = \"<option value=''>Please select an account type</option>\"\n    $.each data, (i) ->\n      options += \"<option value=''\" + data[i][0] + \"'>\" + data[i][1] + \"</option>\"\n    account_type_select.append options\n\najaxPortfolioCall = (e)-> # catch the form's submit event\n  \"use strict\"\n  e.preventDefault()\n  edit_portfolio_form = $(\".variable-product-form\")\n  $.ajax # create an AJAX call...\n    data: edit_portfolio_form.serialize() # get the form data\n    type: edit_portfolio_form.attr(\"method\") # GET or POST\n    url: edit_portfolio_form.attr(\"action\") # the file to call\n    success: (response) -> # on success..\n      edit_portfolio_form.html response # update the DIV\n      $(\".variable-product-form\").submit(ajaxPortfolioCall)\n      providerselect = $('select.providerselect')\n      provider = providerselect.val()\n      parent_form = providerselect.closest(\".product-form\")\n      balance = parent_form.find(\"#id_balance\").val().replace(/,/g, \"\").replace(/£/g, \"\")\n      retrieveProducts(provider, balance, parent_form)\n      return\n  return\n\najaxReminderCall = (e)-> # catch the form's submit event\n  \"use strict\"\n  e.preventDefault()\n  edit_reminder_form = $(\".fixed-product-form\")\n  $.ajax # create an AJAX call...\n    data: edit_reminder_form.serialize() # get the form data\n    type: edit_reminder_form.attr(\"method\") # GET or POST\n    url: edit_reminder_form.attr(\"action\") # the file to call\n    success: (response) -> # on success..\n      edit_reminder_form.html response # update the DIV\n      $(\".fixed-product-form\").submit(ajaxReminderCall)\n      provider = $(select.fixedproviderselect).val()\n      retrieveAccountType provider\n      return\n  return\n\najaxOpeningCall = -> # catch the form's submit event\n  \"use strict\"\n  opening_date_form = $(\".opening-date-form\")\n  $.ajax # create an AJAX call...\n    data: opening_date_form.serialize() # get the form data\n    type: opening_date_form.attr(\"method\") # GET or POST\n    url: opening_date_form.attr(\"action\") # the file to call\n    success: -> # on success..\n      $.colorbox.close() # update the DIV\n\nreloadPage = ->\n  \"use strict\"\n  location.reload true\n\nrebindInputChange = ->\n  \"use strict\"\n  if typeof $(\"select.providerselect\").select2 == \"function\"\n    $(\"select.providerselect\").select2()\n  if typeof $(\"select.productselect\").select2 == \"function\"\n    $(\"select.productselect\").select2()\n  if typeof $(\"select.fixedproviderselect\").select2 == \"function\"\n    $(\"select.fixedproviderselect\").select2()\n  $(\"select.productselect\").empty()\n\nbody.on 'change', \"select.fixedproviderselect\", (event)->\n  provider = $(event.target).val()\n  account_type = parent.nextAll(\"select.account-type\")\n  account_type.empty()\n  if provider > 0\n    retrieveAccountType provider\n  else\n    account_type.append \"<option value =''>Please enter your details</option>\"\n\nbody.on 'change', \"select.providerselect\", (event) ->\n  provider = $(event.target).val()\n  parent_form = $(event.target).closest(\".product-form\")\n  balance = parent_form.find(\"#id_balance\").val().replace(/,/g, \"\").replace(/£/g, \"\")\n  product_select = $(\"select.productselect\")\n  product_select.select2()\n  product_select.empty()\n  if provider > 0 and balance > 0\n    retrieveProducts provider, balance, parent_form\n  else\n    product_select.append \"<option value=''>Please enter your details</option>\"\n  product_select.select2 \"val\", \"\"\n\nbody.on 'keyup', '#id_balance', (event) ->\n  event_target = $(event.target)\n  parent_form = event_target.closest(\".product-form\")\n  provider = $(\"select.providerselect\").val()\n  balance = event_target.val().replace(/,/g, \"\")\n  product_select = $(\"select.productselect\")\n  product_select.empty()\n  if provider > 0 and balance > 0\n    retrieveProducts provider, balance, parent_form\n  else\n    product_select.append \"<option value=''>Please enter your details</option>\"\n\nbody.on 'change', \"select.productselect\", (event) ->\n  id = $(event.target).val()\n  checkOpening id\n\n$(document).ready ->\n  \"use strict\"\n  rebindInputChange()\n  retrieveProducts()\n  $(\".variable-product-form\").submit(ajaxPortfolioCall)\n  $(\".fixed-product-form\").submit(ajaxReminderCall)\n#  $(\".variable-product-form\").validate\n#    submitHandler: ->\n#      #this runs when the form validated successfully\n#      ajaxPortfolioCall() #submit it the form\n#\n#  $(\".fixed-product-form\").validate\n#    submitHandler: ->\n#      #this runs when the form validated successfully\n#      ajaxReminderCall() #submit it the form\n\n  $(\".opening-date-form\").validate\n    submitHandler: ->\n      #this runs when the form validated successfully\n      ajaxOpeningCall() #submit it the form\n\nbody.on 'hidden.bs.modal', (event)->\n  event_target = $(event.target)\n  if event_target.is($('.js-threshold-form')) then null else location.reload true\n"]}